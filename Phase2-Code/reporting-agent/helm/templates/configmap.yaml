apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "reporting-agent.fullname" . }}-config
  labels:
    {{- include "reporting-agent.labels" . | nindent 4 }}
data:
  app-config.yaml: |
    reporting:
      daily_report_time: {{ .Values.reporting.dailyReportTime | quote }}
      weekly_report_day: {{ .Values.reporting.weeklyReportDay | quote }}
      weekly_report_time: {{ .Values.reporting.weeklyReportTime | quote }}
      formats:
        {{- range .Values.reporting.formats }}
        - {{ . }}
        {{- end }}
      retention_days: {{ .Values.reporting.retentionDays }}
    
    integrations:
      task_manager:
        enabled: {{ .Values.integrations.taskManager.enabled }}
        url: {{ .Values.integrations.taskManager.url | quote }}
        timeout: {{ .Values.integrations.taskManager.timeout }}
      
      workflow_automation:
        enabled: {{ .Values.integrations.workflowAutomation.enabled }}
        url: {{ .Values.integrations.workflowAutomation.url | quote }}
        timeout: {{ .Values.integrations.workflowAutomation.timeout }}
    
    anomaly_detection:
      enabled: {{ .Values.anomalyDetection.enabled }}
      threshold: {{ .Values.anomalyDetection.threshold }}
      alert_channels:
        {{- range .Values.anomalyDetection.alertChannels }}
        - {{ . }}
        {{- end }}
    
    logging:
      level: {{ .Values.logging.level | quote }}
      format: {{ .Values.logging.format | quote }}
    
    monitoring:
      enabled: {{ .Values.metrics.enabled }}
      port: {{ .Values.metrics.port }}
